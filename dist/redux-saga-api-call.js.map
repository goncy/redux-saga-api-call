{"version":3,"file":"redux-saga-api-call.js","sources":["../src/index.js"],"sourcesContent":["import {put, select, call} from 'redux-saga/effects'\n\n/**\n * Retrieves data from a passed selector and dispatch an START action with that information, then calls the api with the information merged with the payload, if the api call succedded, dispatches a SUCCESS action with the response on the payload, otherwise, dispatches a FAILURE action with the error\n * @param {function} apiMethod\n * @param {object} options\n * @return {function} generator function that receives the action from the saga\n */\nfunction apiSaga (apiMethod, options = {}) {\n  const {selectFromState, transformResponse, transformError} = options\n  return function* apiSagaResponse (action) {\n    const selectedData = selectFromState\n      ? yield select(selectFromState)\n      : {}\n\n    yield put({\n      type: `${action.type}_START`,\n      payload: action.payload,\n      selectedData\n    })\n\n    const {response, error} = yield call(\n      apiMethod,\n      Object.assign(\n        {},\n        {\n          selectedData\n        },\n        {\n          payload: action.payload\n        }\n      )\n    )\n\n    if (response) {\n      yield put({\n        type: `${action.type}_SUCCESS`,\n        payload: transformResponse\n          ? transformResponse(response)\n          : response\n      })\n    } else {\n      yield put({\n        type: `${action.type}_FAILURE`,\n        payload: transformError\n          ? transformError(error)\n          : error\n      })\n    }\n  }\n}\n\nexport default apiSaga\n"],"names":["apiSaga","apiMethod","options","selectFromState","transformResponse","transformError","apiSagaResponse","action","select","put","type","payload","call","response","error"],"mappings":";;;;;;;;;AAEA;;;;;;AAMA,SAASA,OAAT,CAAkBC,SAAlB,EAA2C;MAAdC,OAAc,uEAAJ,EAAI;MAClCC,eADkC,GACoBD,OADpB,CAClCC,eADkC;MACjBC,iBADiB,GACoBF,OADpB,CACjBE,iBADiB;MACEC,cADF,GACoBH,OADpB,CACEG,cADF;;kCAElC,SAAUC,eAAV,CAA2BC,MAA3B;;;;;;;iBACgBJ,eADhB;;;;;;mBAEKK,yBAAOL,eAAP,CAFL;;;;;;;;0BAGD,EAHC;;;wBAAA;;mBAKCM,sBAAI;oBACCF,OAAOG,IAAhB,WADQ;uBAECH,OAAOI,OAFR;;aAAJ,CALD;;;;mBAW2BC,uBAC9BX,SAD8B,EAE9B,eACE,EADF,EAEE;;aAFF,EAKE;uBACWM,OAAOI;aANpB,CAF8B,CAX3B;;;;oBAAA,QAWEE,QAXF;iBAAA,QAWYC,KAXZ;;iBAwBDD,QAxBC;;;;;;mBAyBGJ,sBAAI;oBACCF,OAAOG,IAAhB,aADQ;uBAECN,oBACLA,kBAAkBS,QAAlB,CADK,GAELA;aAJA,CAzBH;;;;;;;;mBAgCGJ,sBAAI;oBACCF,OAAOG,IAAhB,aADQ;uBAECL,iBACLA,eAAeS,KAAf,CADK,GAELA;aAJA,CAhCH;;;;;;;OAAUR,eAAV;GAAP;CA0CF;;;;"}