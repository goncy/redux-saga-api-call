{"version":3,"file":"redux-saga-api-call.js","sources":["../src/index.js"],"sourcesContent":["import {put, select, call} from 'redux-saga/effects'\n\n/**\n * Retrieves data from a passed selector and dispatch an START action with that information, then calls the api with the information merged with the payload, if the api call succedded, dispatches a SUCCESS action with the response on the payload, otherwise, dispatches a FAILURE action with the error\n * @param {function} apiMethod\n * @param {function} selector\n * @return {function} generator function that receives the action from the saga\n */\nfunction apiSaga (apiMethod, options) {\n  const {transformPayload, transformResponse, transformError} = options\n  return function* apiSagaResponse (action) {\n    if (!action) return\n    const selectedData = transformPayload ? yield select(transformPayload) : {}\n\n    yield put({\n      type: `${action.type}_START`,\n      payload: action.payload,\n      selectedData\n    })\n\n    try {\n      const result = yield call(apiMethod, Object.assign({}, selectedData, action.payload))\n      return yield put({\n        type: `${action.type}_SUCCESS`,\n        payload: transformResponse ? transformResponse(result) : result\n      })\n    } catch (error) {\n      return yield put({\n        type: `${action.type}_FAILURE`,\n        payload: transformError ? transformError(error) : error\n      })\n    }\n  }\n}\n\nexport default apiSaga\n"],"names":["apiSaga","apiMethod","options","transformPayload","transformResponse","transformError","apiSagaResponse","action","select","put","type","payload","call","selectedData","result"],"mappings":";;;;;;;;;AAEA;;;;;;AAMA,SAASA,OAAT,CAAkBC,SAAlB,EAA6BC,OAA7B,EAAsC;MAC7BC,gBAD6B,GAC0BD,OAD1B,CAC7BC,gBAD6B;MACXC,iBADW,GAC0BF,OAD1B,CACXE,iBADW;MACQC,cADR,GAC0BH,OAD1B,CACQG,cADR;;kCAE7B,SAAUC,eAAV,CAA2BC,MAA3B;;;;;;gBACAA,MADA;;;;;;;;iBAEgBJ,gBAFhB;;;;;;mBAEyCK,yBAAOL,gBAAP,CAFzC;;;;;;;;0BAEoE,EAFpE;;;wBAAA;;mBAICM,sBAAI;oBACCF,OAAOG,IAAhB,WADQ;uBAECH,OAAOI,OAFR;;aAAJ,CAJD;;;;;mBAWkBC,uBAAKX,SAAL,EAAgB,eAAc,EAAd,EAAkBY,YAAlB,EAAgCN,OAAOI,OAAvC,CAAhB,CAXlB;;;kBAAA;;mBAYUF,sBAAI;oBACNF,OAAOG,IAAhB,aADe;uBAENN,oBAAoBA,kBAAkBU,MAAlB,CAApB,GAAgDA;aAF9C,CAZV;;;;;;;;;mBAiBUL,sBAAI;oBACNF,OAAOG,IAAhB,aADe;uBAENL,iBAAiBA,2BAAjB;aAFE,CAjBV;;;;;;;;;;OAAUC,eAAV;GAAP;CAyBF;;;;"}